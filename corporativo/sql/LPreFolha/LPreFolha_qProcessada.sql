Select
  LPreFolha.State_Id                           as State,
  to_char(LPreFolha.lUpd,'dd/mm/yyyy hh24:mi') as LUpd,
  LPreFolha.GradAlu_01_Id  as GradAlu_1,
  LPreFolha.GradAlu_02_Id  as GradAlu_2,
  LPreFolha.GradAlu_03_Id  as GradAlu_3,
  LPreFolha.GradAlu_04_Id  as GradAlu_4,
  LPreFolha.GradAlu_05_Id  as GradAlu_5,
  LPreFolha.GradAlu_06_Id  as GradAlu_6,
  LPreFolha.GradAlu_07_Id  as GradAlu_7,
  LPreFolha.GradAlu_08_Id  as GradAlu_8,
  LPreFolha.GradAlu_09_Id  as GradAlu_9,
  LPreFolha.GradAlu_10_Id  as GradAlu_10,
  LPreFolha.GradAlu_11_Id  as GradAlu_11,
  LPreFolha.GradAlu_12_Id  as GradAlu_12,
  LPreFolha.GradAlu_13_Id  as GradAlu_13,
  LPreFolha.GradAlu_14_Id  as GradAlu_14,
  LPreFolha.GradAlu_15_Id  as GradAlu_15,
  LPreFolha.GradAlu_16_Id  as GradAlu_16,
  LPreFolha.GradAlu_17_Id  as GradAlu_17,
  LPreFolha.GradAlu_18_Id  as GradAlu_18,
  LPreFolha.GradAlu_19_Id  as GradAlu_19,
  LPreFolha.GradAlu_20_Id  as GradAlu_20,
  LPreFolha.GradAlu_21_Id  as GradAlu_21,
  LPreFolha.GradAlu_22_Id  as GradAlu_22,
  LPreFolha.GradAlu_23_Id  as GradAlu_23,
  LPreFolha.GradAlu_24_Id  as GradAlu_24,
  LPreFolha.GradAlu_25_Id  as GradAlu_25,
  LPreFolha.GradAlu_26_Id  as GradAlu_26,
  LPreFolha.GradAlu_27_Id  as GradAlu_27,
  LPreFolha.GradAlu_28_Id  as GradAlu_28,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_01_Id),27)  as WPessoa_1,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_02_Id),27)  as WPessoa_2,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_03_Id),27)  as WPessoa_3,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_04_Id),27)  as WPessoa_4,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_05_Id),27)  as WPessoa_5,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_06_Id),27)  as WPessoa_6,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_07_Id),27)  as WPessoa_7,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_08_Id),27)  as WPessoa_8,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_09_Id),27)  as WPessoa_9,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_10_Id),27)  as WPessoa_10,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_11_Id),27)  as WPessoa_11,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_12_Id),27)  as WPessoa_12,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_13_Id),27)  as WPessoa_13,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_14_Id),27)  as WPessoa_14,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_15_Id),27)  as WPessoa_15,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_16_Id),27)  as WPessoa_16,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_17_Id),27)  as WPessoa_17,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_18_Id),27)  as WPessoa_18,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_19_Id),27)  as WPessoa_19,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_20_Id),27)  as WPessoa_20,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_21_Id),27)  as WPessoa_21,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_22_Id),27)  as WPessoa_22,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_23_Id),27)  as WPessoa_23,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_24_Id),27)  as WPessoa_24,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_25_Id),27)  as WPessoa_25,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_26_Id),27)  as WPessoa_26,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_27_Id),27)  as WPessoa_27,
  ShortName(GradAlu_gsRetWPessoaNome(LPreFolha.GradAlu_28_Id),27)  as WPessoa_28,
  LPreFolha.Falta_01 as Falta_1,
  LPreFolha.Falta_02 as Falta_2,
  LPreFolha.Falta_03 as Falta_3,
  LPreFolha.Falta_04 as Falta_4,
  LPreFolha.Falta_05 as Falta_5,
  LPreFolha.Falta_06 as Falta_6,
  LPreFolha.Falta_07 as Falta_7,
  LPreFolha.Falta_08 as Falta_8,
  LPreFolha.Falta_09 as Falta_9,
  LPreFolha.Falta_10 as Falta_10,
  LPreFolha.Falta_11 as Falta_11,
  LPreFolha.Falta_12 as Falta_12,
  LPreFolha.Falta_13 as Falta_13,
  LPreFolha.Falta_14 as Falta_14,
  LPreFolha.Falta_15 as Falta_15,
  LPreFolha.Falta_16 as Falta_16,
  LPreFolha.Falta_17 as Falta_17,
  LPreFolha.Falta_18 as Falta_18,
  LPreFolha.Falta_19 as Falta_19,
  LPreFolha.Falta_20 as Falta_20,
  LPreFolha.Falta_21 as Falta_21,
  LPreFolha.Falta_22 as Falta_22,
  LPreFolha.Falta_23 as Falta_23,
  LPreFolha.Falta_24 as Falta_24,
  LPreFolha.Falta_25 as Falta_25,
  LPreFolha.Falta_26 as Falta_26,
  LPreFolha.Falta_27 as Falta_27,
  LPreFolha.Falta_28 as Falta_28,
  to_char(LPre.Dt1,'dd/mm/yyyy') as Data1,
  to_char(LPre.Dt2,'dd/mm/yyyy') as Data2,
  to_char(LPre.Dt3,'dd/mm/yyyy') as Data3,
  to_char(LPre.Dt1,'HH24"h"MI"min."') as Horario1,
  to_char(LPre.Dt2,'HH24"h"MI"min."') as Horario2,
  to_char(LPre.Dt3,'HH24"h"MI"min."') as Horario3,
  to_char(QtdAulas1,'00') as QtdAulas1,
  to_char(QtdAulas2,'00') as QtdAulas2,
  to_char(QtdAulas3,'00') as QtdAulas3
from
  LPreFolha,
  LPre
where
  LPreFolha.LPre_Id = LPre.Id
and
  SubStr(LPreFolha.Id,8,7) = p_LPreFolha_CodFolha 
