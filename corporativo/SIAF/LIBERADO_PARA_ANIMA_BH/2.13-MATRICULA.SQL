SELECT 
  MATRIC_GSCODALUNOEXT( GRADALU.MATRIC_ID ) AS COD_ALUNO_EXT,
  TO_CHAR(TURMAOFE.ID)||TO_CHAR(CURR.CURSO_MIG_ID)||TO_CHAR(CURRXDISC.DISC_ID)||((PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALTEORIA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALPRATICA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALLAB,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALEXERC,0)))||'T'||GRADALU.DIVTURMA_TEORIA_ID AS COD_TURMA_EXT,
  GRADALU.STATE_ID AS COD_STA_MATRICULA_EXT,
  STATE.NOME AS DSC_STA_MATRICULA,
  NULL AS COD_SOLICITACAO_EXT  	
FROM
  TURMAOFE,
  CURRXDISC,
  CURROFE,
  CURR,
  GRADALU,
  MATRIC,
  PLETIVO,
  STATE
WHERE
  CURROFE.CURR_ID=CURR.ID
AND
  GRADALU.STATE_ID=STATE.ID
AND
  GRADALU.TURMAOFE_ID=TURMAOFE.ID
AND
  CURRXDISC.ID=GRADALU.CURRXDISC_ID
AND
  GRADALU.STATE_ID <> 3000000003002
AND
  MATRIC.ID=GRADALU.MATRIC_ID
AND
  TURMAOFE.CURROFE_ID=CURROFE.ID  
AND
  PLETIVO.ID=CURROFE.PLETIVO_ID
AND 
  NVL(CHSEMANALTEORIA,0) > 0
AND
  NVL(CHTOTAL,0) = 0
UNION
SELECT 
  MATRIC_GSCODALUNOEXT( GRADALU.MATRIC_ID ) AS COD_ALUNO_EXT,
  TO_CHAR(TURMAOFE.ID)||TO_CHAR(CURR.CURSO_MIG_ID)||TO_CHAR(CURRXDISC.DISC_ID)||((PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALTEORIA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALPRATICA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALLAB,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALEXERC,0)))||'P'||GRADALU.DIVTURMA_PRATICA_ID AS COD_TURMA_EXT,
  GRADALU.STATE_ID AS COD_STA_MATRICULA_EXT,
  STATE.NOME AS DSC_STA_MATRICULA,
  NULL AS COD_SOLICITACAO_EXT  	
FROM
  TURMAOFE,
  CURRXDISC,
  CURROFE,
  CURR,
  GRADALU,
  MATRIC,
  PLETIVO,
  STATE
WHERE
  CURROFE.CURR_ID=CURR.ID
AND
  GRADALU.STATE_ID=STATE.ID
AND
  GRADALU.TURMAOFE_ID=TURMAOFE.ID
AND
  CURRXDISC.ID=GRADALU.CURRXDISC_ID
AND
  GRADALU.STATE_ID <> 3000000003002
AND
  MATRIC.ID=GRADALU.MATRIC_ID
AND
  TURMAOFE.CURROFE_ID=CURROFE.ID  
AND
  PLETIVO.ID=CURROFE.PLETIVO_ID
AND 
  NVL(CHSEMANALPRATICA,0) > 0
AND
  NVL(CHTOTAL,0) = 0
UNION
SELECT 
  MATRIC_GSCODALUNOEXT( GRADALU.MATRIC_ID ) AS COD_ALUNO_EXT,
  TO_CHAR(TURMAOFE.ID)||TO_CHAR(CURR.CURSO_MIG_ID)||TO_CHAR(CURRXDISC.DISC_ID)||((PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALTEORIA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALPRATICA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALLAB,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALEXERC,0)))||'L'||GRADALU.DIVTURMA_LAB_ID AS COD_TURMA_EXT,
  GRADALU.STATE_ID AS COD_STA_MATRICULA_EXT,
  STATE.NOME AS DSC_STA_MATRICULA,
  NULL AS COD_SOLICITACAO_EXT  	
FROM
  TURMAOFE,
  CURRXDISC,
  CURROFE,
  CURR,
  GRADALU,
  MATRIC,
  PLETIVO,
  STATE
WHERE
  CURROFE.CURR_ID=CURR.ID
AND
  MATRIC.STATE_ID=STATE.ID
AND
  GRADALU.TURMAOFE_ID=TURMAOFE.ID
AND
  CURRXDISC.ID=GRADALU.CURRXDISC_ID
AND
  GRADALU.STATE_ID <> 3000000003002
AND
  MATRIC.ID=GRADALU.MATRIC_ID
AND
  TURMAOFE.CURROFE_ID=CURROFE.ID  
AND
  PLETIVO.ID=CURROFE.PLETIVO_ID
AND 
  NVL(CHSEMANALLAB,0) > 0
AND
  NVL(CHTOTAL,0) = 0
AND
  MATRIC.WPESSOA_ID=1600000240191    
UNION
SELECT 
  MATRIC_GSCODALUNOEXT( GRADALU.MATRIC_ID ) AS COD_ALUNO_EXT,
  TO_CHAR(TURMAOFE.ID)||TO_CHAR(CURR.CURSO_MIG_ID)||TO_CHAR(CURRXDISC.DISC_ID)||((PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALTEORIA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALPRATICA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALLAB,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALEXERC,0)))||'E' AS COD_TURMA_EXT,
  MATRIC.STATE_ID AS COD_STA_MATRICULA_EXT,
  STATE.NOME AS DSC_STA_MATRICULA,
  NULL AS COD_SOLICITACAO_EXT  	
FROM
  TURMAOFE,
  CURRXDISC,
  CURROFE,
  CURR,
  GRADALU,
  MATRIC,
  PLETIVO,
  STATE
WHERE
  CURROFE.CURR_ID=CURR.ID
AND
  GRADALU.STATE_ID=STATE.ID
AND
  GRADALU.TURMAOFE_ID=TURMAOFE.ID
AND
  CURRXDISC.ID=GRADALU.CURRXDISC_ID
AND
  GRADALU.STATE_ID <> 3000000003002
AND
  MATRIC.ID=GRADALU.MATRIC_ID
AND
  TURMAOFE.CURROFE_ID=CURROFE.ID  
AND
  PLETIVO.ID=CURROFE.PLETIVO_ID
AND 
  NVL(CHSEMANALEXERC,0) > 0
AND
  NVL(CHTOTAL,0) = 0
UNION  
SELECT 
  MATRIC_GSCODALUNOEXT( GRADALU.MATRIC_ID ) AS COD_ALUNO_EXT,
  TO_CHAR(TURMAOFE.ID)||TO_CHAR(CURSO.ID)||TO_CHAR(CURRXDISC.DISC_ID)||((PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALTEORIA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALPRATICA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALLAB,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALEXERC,0)))||'T'||GRADALU.DIVTURMA_TEORIA_ID AS COD_TURMA_EXT, 
  GRADALU.STATE_ID AS COD_STA_MATRICULA_EXT,
  STATE.NOME AS DSC_STA_MATRICULA,
  NULL AS COD_SOLICITACAO_EXT  	
 FROM
  CURRXDISC,
  CURSO,
  TURMA,
  DISCESP,
  TURMAOFE,
  PLETIVO,
  MATRIC,
  GRADALU,
  STATE
WHERE
  GRADALU.CURRXDISC_ID=CURRXDISC.ID
AND
  GRADALU.STATE_ID=STATE.ID
AND
  GRADALU.STATE_ID <> 3000000003002
AND
  GRADALU.MATRIC_ID=MATRIC.ID
AND
  GRADALU.TURMAOFE_ID=TURMAOFE.ID
AND
  MATRIC.TURMAOFE_ID=TURMAOFE.ID
AND
  TURMA.CURSO_ID=CURSO.ID
AND
  TURMAOFE.TURMA_ID=TURMA.ID
AND
  TURMAOFE.DISCESP_ID=DISCESP.ID
AND
  DISCESP.PLETIVO_ID=PLETIVO.ID
AND 
  NVL(DISCESP.CHSEMANALTEORIA,0) > 0
UNION 
SELECT 
  MATRIC_GSCODALUNOEXT( GRADALU.MATRIC_ID ) AS COD_ALUNO_EXT,
  TO_CHAR(TURMAOFE.ID)||TO_CHAR(CURSO.ID)||TO_CHAR(CURRXDISC.DISC_ID)||((PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALTEORIA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALPRATICA,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALLAB,0))||(PLETIVO.SEMANAS*nvl(CURRXDISC.CHSEMANALEXERC,0)))||'P'||GRADALU.DIVTURMA_PRATICA_ID AS COD_TURMA_EXT, 
  GRADALU.STATE_ID AS COD_STA_MATRICULA_EXT,
  STATE.NOME AS DSC_STA_MATRICULA,
  NULL AS COD_SOLICITACAO_EXT  	
 FROM
  CURRXDISC,
  CURSO,
  TURMA,
  DISCESP,
  TURMAOFE,
  PLETIVO,
  MATRIC,
  GRADALU,
  STATE
WHERE
  GRADALU.CURRXDISC_ID=CURRXDISC.ID
AND
  GRADALU.STATE_ID=STATE.ID
AND
  GRADALU.STATE_ID <> 3000000003002
AND
  GRADALU.MATRIC_ID=MATRIC.ID
AND
  GRADALU.TURMAOFE_ID=TURMAOFE.ID
AND
  MATRIC.TURMAOFE_ID=TURMAOFE.ID
AND
  TURMA.CURSO_ID=CURSO.ID
AND
  TURMAOFE.TURMA_ID=TURMA.ID
AND
  TURMAOFE.DISCESP_ID=DISCESP.ID
AND
  DISCESP.PLETIVO_ID=PLETIVO.ID
AND 
  NVL(DISCESP.CHSEMANALPRATICA,0) > 0
